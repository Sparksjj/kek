<ms-loading *ngIf="load"></ms-loading>

<div class="err_top" style="text-align: center" *ngIf="error && !load">
  {{error}}
</div>

<div fxLayout="column" *ngIf="!load">
  <div fxLayout="row" fxLayoutAlign="center stretch" style="margin: 24px 0;">
    <mat-card fxFlex="100%">

      <mat-card-title style="margin-bottom: 30px;">
        <a [routerLink]="[data.urls.create]" md-button color="primary">Создать {{data.names.ru1}}</a>
      </mat-card-title>

      <mat-card-title>
        <span *ngIf="items?.confirmed?.length > 0; else no_items">Все подтвержденные {{data.names.ru2}}</span>
        <ng-template #no_items>Нет подтвержденных {{data.names.ru3}}</ng-template>
      </mat-card-title>

      <mat-divider *ngIf="items?.length > 0"></mat-divider>

      <mat-card-content fxLayout="row" fxLayoutWrap fxLayoutAlign="space-around stretch" style="margin-top: 30px">

        <table class="table table-hover table-striped table-condensed table-bordered" *ngIf="items?.confirmed.length > 0">
          <thead>
            <tr>
              <th></th>
              <th>Id</th>
              <th>Ссылка</th>
              <th>Категория</th>
              <th>Дата создания</th>
              <th>Удалить</th>
            </tr>
          </thead>
          <tbody>

            <ng-template ngFor let-item [ngForOf]="items?.confirmed">

              <tr style="cursor: pointer; position: relative">
                <td class="avatar-cell">
                  <img class="avatar" [src]="item?.image">
                  <a [routerLink]="[data.urls.show, item?.id]"></a>
                </td>

                <td>
                  {{item?.id}}
                  <a [routerLink]="[data.urls.show, item?.id]"></a>
                </td>

                <td>
                  {{item?.link}}
                  <a [routerLink]="[data.urls.show, item?.id]"></a>
                </td>

                <td>
                  {{item?.type}}
                  <a [routerLink]="[data.urls.show, item?.id]"></a>
                </td>

                <td>
                  {{item?.created_at}}
                  <a [routerLink]="[data.urls.show, item?.id]"></a>
                </td>

                <td>

                  <button mat-icon-button *ngIf="item?.shure" (click)="$event.stopPropagation(); item.shure = false">
                    Нет
                  </button>

                  <button style="float: left" mat-icon-button color="warn" *ngIf="item?.shure" color="warn" (click)="$event.stopPropagation(); deleteItem(item); item.shure = false">
                    Да
                  </button>

                  <button color="warn" *ngIf="!item?.shure" mat-icon-button (click)="$event.stopPropagation(); item.shure = true">
                    <mat-icon>cancel</mat-icon>
                  </button>

                </td>
              </tr>

            </ng-template>

          </tbody>
        </table>

      </mat-card-content>

      <!--  -->

      <mat-card-content style="margin-top: 30px;">

        <mat-card-title>
          <span *ngIf="items?.negotiation?.length > 0; else no_items2">Все неподтвержденные {{data.names.ru2}}</span>
          <ng-template #no_items2>Нет неподтвержденных {{data.names.ru3}}</ng-template>
        </mat-card-title>

        <table class="table table-hover table-striped table-condensed table-bordered" *ngIf="items?.negotiation.length > 0">
          <thead>
            <tr>
              <th></th>
              <th>Id</th>
              <th>Ссылка</th>
              <th>Категория</th>
              <th>Дата создания</th>
              <th>Удалить</th>
            </tr>
          </thead>
          <tbody>

            <ng-template ngFor let-item [ngForOf]="items?.negotiation">

              <tr style="cursor: pointer; position: relative">
                <td class="avatar-cell">
                  <img class="avatar" [src]="item?.image">
                  <a [routerLink]="[data.urls.show, item?.id]"></a>
                </td>

                <td>
                  {{item?.id}}
                  <a [routerLink]="[data.urls.show, item?.id]"></a>
                </td>

                <td>
                  {{item?.link}}
                  <a [routerLink]="[data.urls.show, item?.id]"></a>
                </td>

                <td>
                  {{item?.type}}
                  <a [routerLink]="[data.urls.show, item?.id]"></a>
                </td>

                <td>
                  {{item?.created_at}}
                  <a [routerLink]="[data.urls.show, item?.id]"></a>
                </td>

                <td>

                  <button mat-icon-button *ngIf="item?.shure" (click)="$event.stopPropagation(); item.shure = false">
                    Нет
                  </button>

                  <button style="float: left" mat-icon-button color="warn" *ngIf="item?.shure" color="warn" (click)="$event.stopPropagation(); deleteItem(item); item.shure = false">
                    Да
                  </button>

                  <button color="warn" *ngIf="!item?.shure" mat-icon-button (click)="$event.stopPropagation(); item.shure = true">
                    <mat-icon>cancel</mat-icon>
                  </button>

                </td>
              </tr>

            </ng-template>

          </tbody>
        </table>

      </mat-card-content>

      <ms-loading-overlay [isLoading]="loadUpdate"></ms-loading-overlay>
    </mat-card>
  </div>
</div>
